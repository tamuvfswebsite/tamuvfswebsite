<% content_for :title, "My Role Applications" %>

<div class="applications-container">
  <div class="page-header">
    <h1>My Role Applications</h1>
    <% if @role_applications.count < 10 %>
      <%= link_to "Apply for New Role", new_role_application_path, class: "btn btn-primary" %>
    <% else %>
      <p class="text-warning">You have reached the maximum limit of 10 applications.</p>
    <% end %>
  </div>

  <% if notice.present? %>
    <div class="alert alert-success"><%= notice %></div>
  <% end %>

  <% if @role_applications.any? %>
    <div class="applications-list">
      <table class="table">
        <thead>
          <tr>
            <th>Role</th>
            <th>Status</th>
            <th>Submitted</th>
            <th>Last Updated</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @role_applications.each do |application| %>
            <tr>
              <td><%= application.organizational_role.name %></td>
              <td>
                <span class="badge badge-<%= application.status %>">
                  <%= application.status.humanize %>
                </span>
              </td>
              <td><%= application.created_at.strftime("%b %d, %Y") %></td>
              <td><%= application.updated_at.strftime("%b %d, %Y") %></td>
              <td class="actions-cell">
                <%= button_to "View", application, method: :get, class: "btn btn-outline", form: { style: "display: inline; margin: 0; vertical-align: top;" } %>
                <%= button_to "Edit", edit_role_application_path(application), method: :get, class: "btn btn-outline", form: { style: "display: inline; margin: 0; vertical-align: top;" } %>
                <%= button_to "Delete", role_application_path(application), method: :delete, class: "btn btn-danger", form: { style: "display: inline; margin: 0; vertical-align: top;" }, data: { confirm: "Are you sure you want to delete this application?" } %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="empty-state">
      <p>You haven't submitted any role applications yet.</p>
      <%= link_to "Submit Your First Application", new_role_application_path, class: "btn btn-primary" %>
    </div>
  <% end %>

  <div class="application-count">
    <p><%= @role_applications.count %> of 10 applications used</p>
  </div>
</div>
